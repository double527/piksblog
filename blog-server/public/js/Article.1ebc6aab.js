(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Article"],{"023a":function(t,e,n){},"02c5":function(t,e,n){},"1b2c":function(t,e,n){"use strict";n("023a")},"22ec":function(t,e,n){"use strict";n("d123")},"3ad6":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.article.id?n("div",[n("ArticleContent",{attrs:{article:t.article}}),n("CommentTextArea",{attrs:{aid:t.article.id}}),n("CommentList",{attrs:{comments:t.article.comments}})],1):t._e()},a=[],s=(n("caad"),n("2532"),n("96cf"),n("1da1")),c=n("5530"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",[n("div",{staticClass:"blog-article markdown-body"},[n("h1",{staticClass:"blog-article--title"},[t._v(t._s(t.article.title))]),n("ArticleBarInfo",{attrs:{info:t.info,id:t.article.id}}),t._m(0)],1)])},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"blog-article--content",domProps:{innerHTML:t._s(t.article.content)}})}],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"blog-article--info"},[n("span",{staticClass:"blog-info--item"},[t._v(" 作者: "+t._s(t.info.nikname)+" ")]),n("span",{staticClass:"blog-info--item"},[n("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.info.date)+" ")]),n("div",{staticClass:"hidden-xs-only"},[n("span",{staticClass:"blog-info--item",on:{click:t.like}},[n("i",{staticClass:"el-icon-star-on blog-info-like",class:{active:t.isLike}}),t._v(" "+t._s(t.likeNum)+" ")]),n("span",{staticClass:"blog-info--item"},[n("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(t.info.hit_num)+" ")]),n("span",{staticClass:"blog-info--item"},[n("i",{staticClass:"el-icon-edit-outline"}),t._v(" "+t._s(t.info.comment_num)+" ")])])])},m=[],u=n("2f62"),d=Object(u["a"])("likes"),f=d.mapGetters,p=d.mapActions,v={name:"ArticleBarInfo",props:{info:{type:Object},id:{type:String}},data:function(){return{isInitLike:!1}},created:function(){this.isInitLike=this.isLike},computed:Object(c["a"])({isLike:function(){var t=this.id;return this.localLike(t)},likeNum:function(){var t=this.isLike?0:-1;return Math.max(this.info.like_num+!this.isInitLike+t,0)}},f({localLike:"isLike"})),methods:Object(c["a"])({like:function(){this[this.isLike?"pullLike":"pushLike"]({aid:this.id}),this.sendLikes({aid:this.id})}},p(["pullLike","pushLike","sendLikes"])),beforeDestroy:function(){}},h=v,b=(n("5c25"),n("2877")),_=Object(b["a"])(h,l,m,!1,null,null,null),g=_.exports,k={name:"ArticleContent",props:{article:{type:Object,default:function(){return{title:"默认标题",date:"默认日期",like_num:0,hit_num:0,comment_num:0,content:""}}}},components:{ArticleBarInfo:g},data:function(){return{}},computed:{info:function(){var t=this.article,e=t.like_num,n=t.hit_num,i=t.comment_num,a=t.date;return{like_num:e,hit_num:n,comment_num:i,date:a,nikname:this.nikname}},nikname:function(){var t,e;return(null===(t=this.article)||void 0===t||null===(e=t.author)||void 0===e?void 0:e.nikname)||"侠名"}},methods:{}},C=k,y=(n("7da0"),Object(b["a"])(C,o,r,!1,null,null,null)),x=y.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticClass:"blog-comment-card"},[n("div",{staticClass:"blog-comment blog-comment--editor"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentVal,expression:"commentVal"}],ref:"textarea",staticClass:"blog-comment--input",attrs:{name:"comment",autofocus:""},domProps:{value:t.commentVal},on:{input:function(e){e.target.composing||(t.commentVal=e.target.value)}}}),n("el-button",{attrs:{type:"primary"},on:{click:t.submitComment}},[t._v("提交")])],1)])},A=[],$=(n("498a"),{name:"CommentTextArea",inject:["getArticleById"],props:{aid:{type:String}},data:function(){return{commentVal:""}},mounted:function(){var t=this;this.$EventBus.$on("focusTextarea",(function(){t.focusTextarea()}))},methods:{focusTextarea:function(){this.$refs.textarea.focus()},submitComment:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.commentVal.trim().length){e.next=4;break}return t.$notify.info({title:"请填写评论内容"}),t.focusTextarea(),e.abrupt("return");case 4:return e.prev=4,e.next=7,t.$api({type:"postComment",data:{aid:t.aid,content:t.commentVal}});case 7:t.$notify.success({title:"评论成功"}),t.getArticleById(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](4),t.$notify.error({title:"评论失败",message:e.t0.message});case 14:t.commentVal="";case 15:case"end":return e.stop()}}),e,null,[[4,11]])})))()}}}),j=$,I=(n("ab78"),Object(b["a"])(j,L,A,!1,null,null,null)),w=I.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.commentLength?n("el-card",[n("div",{staticClass:"blog-comment blog-comment--list"},[n("h3",[t._v("评论列表")]),n("ul",t._l(t.comments,(function(t){return n("CommentItem",{key:t.id,attrs:{uid:t.uid,content:t.content,date:t.date}})})),1)])]):t._e()},B=[],E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"blog-comment--item"},[n("div",{staticClass:"blog-comment--user blog-line blog-line--row "},[n("div",{staticClass:"blog-comment--avatar"},[n("img",{attrs:{src:t.uid.avatar,alt:"!"}})]),n("span",{staticClass:"blog-comment--name"},[t._v(t._s(t.uid.nikname))])]),n("p",{staticClass:"blog-comment-content"},[t._v(t._s(t.content))]),n("p",{staticClass:"blog-comment-date"},[t._v(t._s(t.date))])])},T=[],V={name:"CommentItem",props:{uid:{type:Object},content:{type:String},date:{type:String}},data:function(){return{}},mounted:function(){},methods:{}},R=V,S=Object(b["a"])(R,E,T,!1,null,"9cadf5d6",null),N=S.exports,J={name:"CommentList",components:{CommentItem:N},props:{comments:{type:Array}},data:function(){return{}},computed:{commentLength:function(){var t;return(null===(t=this.comments)||void 0===t?void 0:t.length)||0},uid:function(){return this.comments}},mounted:function(){},methods:{}},M=J,P=(n("1b2c"),Object(b["a"])(M,O,B,!1,null,null,null)),D=P.exports,G=Object(u["a"])("likes"),H=G.mapActions,q={name:"Article",components:{ArticleContent:x,CommentList:D,CommentTextArea:w},provide:function(){return{getArticleById:this.getArticleById}},data:function(){return{id:"",article:{}}},created:function(){this.id=this.$route.params.id,this.getArticleById()},methods:Object(c["a"])({getArticleById:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i,a,s,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api({type:"getArticleById",data:{id:t.id}});case 3:t.article=e.sent,s=(null===(n=t.article)||void 0===n?void 0:n.like_users)||[],c=null===(i=t.$store.getters.userInfo)||void 0===i?void 0:i._id,o=null===(a=t.article)||void 0===a?void 0:a.id,s.includes(c)&&t.pushLike({aid:o}),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),t.$notify.success({title:"获取失败",message:e.t0.message});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}},H(["pushLike","sendLikes"]))},z=q,F=(n("22ec"),Object(b["a"])(z,i,a,!1,null,null,null));e["default"]=F.exports},"4a8a":function(t,e,n){},"5c25":function(t,e,n){"use strict";n("c525")},"7da0":function(t,e,n){"use strict";n("02c5")},ab78:function(t,e,n){"use strict";n("4a8a")},c525:function(t,e,n){},d123:function(t,e,n){}}]);
//# sourceMappingURL=Article.1ebc6aab.js.map